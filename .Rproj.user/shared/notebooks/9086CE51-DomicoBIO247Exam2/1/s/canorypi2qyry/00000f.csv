"0",""
"0","# uploading FASTQ file"
"0","fastq <- read.table('C:/Users/Whitn/OneDrive/Desktop/BIO247/BIO247Lecture/BIO247Exams/BIO247Exam2/Exam 2/Gene_compare.fastq', header=FALSE,sep=""|"",fill=TRUE)"
"0",""
"0",""
"0","#making vectors with indices since the file is ""name, seq, +, score"""
"0","name <- seq(1, length(fastq$V1), by=4)"
"0","seq <- seq(2, length(fastq$V1), by=4)"
"0","score <- seq(4, length(fastq$V1), by=4)"
"0",""
"0","#using vectors from above to make vectors of name, sequence, and scorechar"
"0","Name <- fastq$V1[name]"
"0","Sequence <- fastq$V1[seq]"
"0","Score_char <- fastq$V1[score]"
"0","Score_val = c()"
"0",""
"0","#creating initial data frame"
"0","fastq_data <- data.frame(Name, Sequence, Score_char)"
"0",""
"0","#finding corresponding ASCII-Sanger-PHRED scores for both samples"
"0","for (x in 1:length(fastq_data$Name)){"
"0","  score_num = c()"
"0","  char <- unlist(strsplit(fastq_data$Score_char[x],""""))"
"0","  for (a in char){"
"0","    score_num <- append(score_num,utf8ToInt(a)-33)"
"0","  }"
"0","  Score_val <- append(Score_val,list(score_num))"
"0","}"
"0",""
"0","# adding each list of score values to a column in the dataframe"
"0","for (i in 1:(length(Score_val))){"
"0","  fastq_data$Score_val[i] <- list(Score_val[i])"
"0","}"
"0",""
"0","#making each sample's score value into a vector (not list)and definding a vector as the difference in scores for each bp"
"0","samp1 <- unlist(fastq_data$Score_val[1])"
"0","samp2 <- unlist(fastq_data$Score_val[2])"
"0","sampdiff <- samp1-samp2"
"0",""
"0",""
"0","#finding which sample has more ""wins"" for each bp (if sampdiff[each] is positive, that means the score in samp1 is higher; if sampdiff[each] is negative, that meanst the score in samp2 is higher)"
"0","samp1freq <- c(0)"
"0","samp2freq <- c(0)"
"0","eqfreq <- c(0)"
"0","for (each in sampdiff){"
"0","  if (each>0){"
"0","    samp1freq <- samp1freq+1"
"0","    } else if (each<0){"
"0","      samp2freq <- samp2freq+2"
"0","      } else"
"0","      eqfreq <- eqfreq+1"
"0","}"
"0",""
"0","samp1freq"
"1","[1]"
"1"," 29"
"1","
"
"0","samp2freq"
"1","[1]"
"1"," 26"
"1","
"
"0","eqfreq"
"1","[1]"
"1"," 10"
"1","
"
"0","#samp1freq > samp2freq, so sample1 probably has better quality"
"0",""
"0","#quick check of average score for each sample to see if it agrees"
"0","mean(samp1)"
"1","[1]"
"1"," 35.71154"
"1","
"
"0","mean(samp2)"
"1","[1]"
"1"," 34.34615"
"1","
"
"0","#sample 1 mean > sample 2 mean, so this agrees that sample1 probably has better quality"
